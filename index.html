<script type="text/javascript" src="components.js"></script>
<script type="text/javascript" src="entity.js"></script>
<script type="text/javascript" src="input.js"></script>

<body style="margin: 0px">
<canvas id="myCanvas">
</canvas>
</body>

<script>
    var CANVAS_WIDTH = 500;
    var CANVAS_HEIGHT = 500;
    canvas = document.getElementById("myCanvas").getContext("2d");
    canvas.width = CANVAS_WIDTH;
    canvas.height = CANVAS_HEIGHT;
</script>

<script type="text/javascript">

    var player = new Entity("player");
    player.addModel(new Square(player, 10, 10, 20, 20, false));
    player.addModel(new ImageModel(player, "img/idiot.gif", true));
    player.addController(new ArrowMove(player));
    player.addController(new Selectable(player));

    var FPS = 30;
    setInterval(function () {
        update();
        draw();
    }, 1000 / FPS);

    function draw() {
        canvas.clearRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);
        for (var com in player.view) {
            if (player.view[com].hasOwnProperty("draw")) {
                player.view[com].draw();
            }
        }
    }

    function update() {
        for (var com in player.controller) {
            if (player.controller[com].hasOwnProperty("update")) {
                player.controller[com].update();
            }
        }
        // To prevent the bug in which the player walks away
        // from the clicked position and loses selection.
        Mouse._used = true;
    }

</script>